package com.misys.tiplus2.apps.ti.tistatic.extsm.entity.persister;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.misys.tiplus2.persistent.EntityPersister;
import com.misys.tiplus2.apps.ti.tistatic.extsm.entity.ExtTICustomerDetails;
import com.misys.tiplus2.apps.ti.tistatic.extsm.entity.Key_ExtTICustomerDetails;
import com.misys.tiplus2.apps.ti.tistatic.tistatic.entity.Key_TICustomerDetails;
import com.misys.tiplus2.apps.ti.tistatic.tistatic.entity.TICustomerDetails;
import com.misys.tiplus2.enigma.customisation.entity.EnigmaCustomisedEntity.ExtraDataMap;

@SuppressWarnings("unchecked")
public class ExtTICustomerDetailsPersister extends EntityPersister {

	// This code will be generated by the builder 
	
	public ExtTICustomerDetailsPersister() {
		setKeyMembers(new MemberDescriptor[] {
            new MemberDescriptor("key", "EXTICUST.KEY29", getBinderFactory().getBinderForType("Long")),
		});
			
		setMembers(new MemberDescriptor[] {
            new MemberDescriptor("typeFlag", "EXTICUST.TYPEFLAG", getBinderFactory().getBinderForType("Integer")),
            new MemberDescriptor("versionStamp", "EXTICUST.TSTAMP", getBinderFactory().getBinderForType("Integer")),
            new MemberDescriptor("Initialised", "EXTICUST.INITED", getBinderFactory().getBinderForType("Integer")),
            new MemberDescriptor("TICustomerDetails.Key", "EXTICUST.TICUST", getBinderFactory().getBinderForType("Long"), TICustomerDetails.class),
		});

		setForeignKeyMappings(new ForeignKeyMappingDescriptor[] {
			new ForeignKeyMappingDescriptor("TICustomerDetails", TICustomerDetails.class),
		});
	}

    private static final String tableName = "EXTICUST";

    /**
     * Gets the table name - in this case EXTICUST
     * <p>
     * Note that the <i>schema</i> must be prefixed to this when constructing
     * SQL statements, for example: <code>schema.EXTICUST</code>
     * 
     * @return the table name
     */
	@Override
	public String getTableName() {       
		return tableName;
	}

	@Override
	public Class<?> getEntityClass() {
		return ExtTICustomerDetails.class;
	}

	public Class<?> getKeyClass() {
		return Key_ExtTICustomerDetails.class;
	}

	@Override
	public ExtTICustomerDetails constructEntity(final Object[] keyValues, final Object[] resultRow) {
		final ExtTICustomerDetails entity = new ExtTICustomerDetails();
		
		// Key members
		final Key_ExtTICustomerDetails key = entity.get$key();
		assignKeyValues(key, keyValues);

		assignMemberValues(entity, resultRow);
		
		return entity;
	}
	
	@Override
	public Key_ExtTICustomerDetails constructKey(final Object[] keyValues) {
		final Key_ExtTICustomerDetails key = new Key_ExtTICustomerDetails();
		assignKeyValues(key, keyValues);
		return key;
	}
	
	@Override
	public void assignKeyValues(final Object object, final Object[] resultRow) {
		final Key_ExtTICustomerDetails result = (Key_ExtTICustomerDetails)object;
		int index = 0;
		result.getKey().setDbValue((java.lang.Long)resultRow[index++]);
	}
	
	@Override
	public void assignMemberValues(final Object object, final Object[] resultRow) {
		final ExtTICustomerDetails result = (ExtTICustomerDetails)object;
		int index = 0;
		result.setTypeFlag((java.lang.Integer)resultRow[index++]);
		result.setVersionStamp((java.lang.Integer)resultRow[index++]);
		result.getInitialised().setDbValue((java.lang.Integer)resultRow[index++]);
		result.getTICustomerDetails().getKey().setDbValue((java.lang.Long)resultRow[index++]);
	}

	@Override
	public Object[] getKeyMemberValues(final Object object) {
		final Key_ExtTICustomerDetails entity = (Key_ExtTICustomerDetails)object;
		final Object[] result = new Object[1];
		int index = 0;
		result[index++] = entity.getKey().getDbValue();
		return result;
	}

	@Override
	public Object[] getMemberValues(final Object object) {
		final ExtTICustomerDetails entity = (ExtTICustomerDetails)object;
		final Object[] result = new Object[4];
		int index = 0;
		result[index++] = entity.getTypeFlag();
		result[index++] = entity.getVersionStamp();
		result[index++] = entity.getInitialised().getDbValue();
		result[index++] = entity.getTICustomerDetails().getKey().getDbValue();
		return result;
	}

	@Override
	public Object[] getMemberValuesForMember(final String memberName, final Object object) {
		if (memberName.equalsIgnoreCase("TICustomerDetails")) {
			final Key_TICustomerDetails member = (Key_TICustomerDetails)object;
			final Object[] result = new Object[1];
			int index = 0;
			result[index++] = member.getKey().getDbValue();
			return result;
		}
		else if (memberName.equalsIgnoreCase("extraDataMap")) {
			final ExtraDataMap member = (ExtraDataMap)object;
			final Object[] result = new Object[0];
			int index = 0;
			return result;
		}
		else {
			throw new IllegalArgumentException("Invalid memberName " + memberName);
		}
	}

	@Override
	public boolean requiresOptimisticLocking() {
		return true;
	}

	@Override
	public int getTypeFlag() {
		return typeFlag;
	}

	@Override
	public int[] getTypeFlags() {
		return typeFlags;
	}

	public static final int typeFlag =  12733;

	private static final int[] typeFlags =  { typeFlag,  };

	@Override
	public Object[] extractKeyValues(ResultSet resultSet) throws SQLException {
		return super.extractKeyValues(resultSet);
	}

	@Override
	public int bindKeyValues(Object[] keyValues, PreparedStatement stmt, final int startIndex) throws SQLException {
		return super.bindKeyValues(keyValues, stmt, startIndex);
	}

    @Override
	public Object getKeyFromEntity(final Object entity) {
		return (((ExtTICustomerDetails)entity).get$key());
	}

}
